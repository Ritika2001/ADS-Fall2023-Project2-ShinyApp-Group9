---
title: "5243Proj2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r setup, include=FALSE}
install.packages('magrittr')
```

```{r library packages, echo=TRUE, message=FALSE, warning=FALSE}
library(tidyverse)
library(tidytext)
library(DT)
library(scales)
library(wordcloud2)
library(gridExtra)
library(ngram)
library(shiny)
library(tm)
```

```{r}
data<- read_csv('C:/Users/Yuche/Desktop/STAT 5243/5243 Proj/DisasterDeclarationsSummaries.csv',show_col_types = FALSE)
FEMA_data <- data
```

```{r, echo=FALSE}
# Define UI
ui <- fluidPage(
  titlePanel("Frequency of disaster for different areas"),
  sidebarLayout(
    sidebarPanel(
      textInput("locationInput", "Enter State or County:", ""),
      actionButton("generateButton", "Generate Disaster Word Cloud")
    ),
    mainPanel(
      tags$div(id = "wordcloudOutput"),
      textOutput("DisasterType")
    )
  )
)
                 
```

```{r, echo=FALSE}
# Define server
server <- function(input, output) {
  # Create a reactive data frame
  filteredData <- reactive({
    req(input$generateButton)
    req(input$locationInput)

    # Filter data based on input location
    filter(disasters, State == input$locationInput | County == input$locationInput)
  })

  # Generate word cloud
  output$wordcloudOutput <- renderUI({
    # Create a corpus
    corpus <- Corpus(VectorSource(filteredData()$IncidentType))

    # Preprocess the text
    corpus <- tm_map(corpus, content_transformer(tolower))
    corpus <- tm_map(corpus, removePunctuation)
    corpus <- tm_map(corpus, removeNumbers)
    corpus <- tm_map(corpus, removeWords, stopwords("english"))
    corpus <- tm_map(corpus, stripWhitespace)

    # Create a term-document matrix
    tdm <- TermDocumentMatrix(corpus)

    # Convert term-document matrix to a matrix
    m <- as.matrix(tdm)

    # Calculate word frequencies
    word_freqs <- sort(rowSums(m), decreasing = TRUE)

    # Create a word cloud
    wordcloud(words = names(word_freqs), freq = word_freqs, min.freq = 1,
              scale = c(3, 0.5), colors = brewer.pal(8, "Dark2"))
  })

  # Display information about the data
  output$infoText <- renderText({
    if (nrow(filteredData()) == 0) {
      return("No data found for the specified location.")
    }

    paste("Showing data for", input$locationInput)
  })
}
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
